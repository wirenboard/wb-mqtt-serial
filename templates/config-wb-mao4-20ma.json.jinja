{% set title_en = title_en | default("WB-MAO4-20mA (4-channel 0-20 mA output module)") -%}
{% set title_ru = title_ru | default("WB-MAO4-20mA (4-–∫–∞–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å —Ç–æ–∫–æ–≤—ã—Ö –≤—ã—Ö–æ–¥–æ–≤ 0-20 –º–ê)") -%}
{% set device_type = device_type | default("wb-mao4-20ma") -%}
{% set group = group | default("g-wb") -%}
{% set device_name = device_name | default("WB-MAO4-20mA") -%}
{% set device_id = device_id | default("wb-mao4-20ma") -%}
{% set has_signature = has_signature | default(true) -%}

{% set INPUTS_NUMBER = 4 -%}
{% set OUTPUTS_NUMBER = 4 -%}
{% set PRESS_TYPES = ["short", "long", "double", "short long"] %}

{
    "title": "template_title",
    "device_type": "{{ device_type }}",
    "group": "{{ group }}",
{% if has_signature %}
    "hw": [
        {
            "signature": "WB-MAO4-20mA"
        }
    ],
{% endif %}
    "device": {
        "name": "{{ device_name }}",
        "id": "{{ device_id }}",
        "max_read_registers": 0,
        "response_timeout_ms": 1,
        "frame_timeout_ms": 8,
        "enable_wb_continuous_read": true,

        "groups": [
            {% for ch_number in range(1, INPUTS_NUMBER + 1) -%}
            {
                "title": "Input {{ ch_number }}",
                "id": "input_{{ ch_number }}"
            },
            {
                "title": "Input Parameters",
                "id": "input_{{ ch_number }}_parameters",
                "group": "input_{{ch_number }}",
                "ui_options": {
                    "wb": {
                        "disable_title": true
                    }
                }
            },
            {
                "title": "Input Counters",
                "id": "input_{{ ch_number }}_counters",
                "group": "input_{{ ch_number }}",
                "ui_options": {
                    "wb": {
                        "disable_title": true
                    }
                }
            },
            {% endfor -%}
            {% for ch_number in range(1, OUTPUTS_NUMBER + 1) -%}
            {
                "title": "Output {{ ch_number }}",
                "id": "g_output_{{ ch_number }}"
            },
            {
                "title": "Output Limits",
                "id": "gg_output_{{ ch_number }}_limits",
                "group": "g_output_{{ ch_number }}"
            },
            {
                "title": "Proccess Value Rates",
                "id": "gg_output_{{ ch_number }}_rates",
                "group": "g_output_{{ ch_number }}"
            },
            {
                "title": "Output Channels",
                "id": "gg_output_{{ ch_number }}_channels",
                "group": "g_output_{{ ch_number }}",
                "ui_options": {
                    "wb": {
                        "disable_title": true
                    }
                }
            },
            {% endfor -%}
            {
                "title": "General",
                "id": "general"
            },
            {
                "title": "HW Info",
                "id": "hw_info"
            },
            {
                "title": "Debug",
                "id": "debug"
            }
        ],
        "parameters": [
            {% for ch_number in range(0, INPUTS_NUMBER) -%}
            {
                "id": "input_{{ch_number + 1}}_hold_time",
                "title": "Long Press Time (ms)",
                "description": "input_hold_time_description",
                "address": {{1100 + ch_number}},
                "reg_type": "holding",
                "default": 1000,
                "min": 500,
                "max": 5000,
                "group": "input_{{ch_number + 1}}_parameters",
                "order": 1
            },
            {
                "id": "input_{{ch_number + 1}}_double_time",
                "title": "Second Press Waiting Time (ms)",
                "description": "input_double_time_description",
                "address": {{1140 + ch_number}},
                "reg_type": "holding",
                "default": 300,
                "min": 0,
                "max": 2000,
                "group": "input_{{ch_number + 1}}_parameters",
                "order": 2
            },
            {
                "id": "input_{{ch_number + 1}}_debounce_time",
                "title": "Debounce Time (ms)",
                "description": "input_debounce_time_description",
                "address": {{1160 + ch_number}},
                "reg_type": "holding",
                "default": 50,
                "min": 5,
                "max": 200,
                "group": "input_{{ch_number + 1}}_parameters",
                "order": 3
            },
            {% endfor -%}
            {% for ch_number in range(1, OUTPUTS_NUMBER + 1) -%}
            {
                "id": "output_{{ch_number}}_mode",
                "title": "Output Mode",
                "description": "output_mode_description",
                "address": {{1160 + ch_number}},
                "reg_type": "holding",
                "enum": [0, 1, 2],
                "default": 0,
                "enum_titles": [
                    "0..100 % ü†ö 0..20 mA",
                    "0..100 % ü†ö 4..20 mA",
                    "Custom Limits"
                ],
                "group": "g_output_{{ch_number}}"
            },
            {
                "id": "output{{ ch_number }}_min",
                "title": "Current at 0% Proccess Value (mA)",
                "description": "level_0_current_description",
                "address": {{ 912 + ch_number - 1 }},
                "reg_type": "holding",
                "default": 0,
                "scale": 0.001,
                "min": 0,
                "max": 20,
                "group": "gg_output_{{ ch_number }}_limits",
                "condition": "output_{{ch_number}}_mode==2"
            },
            {
                "id": "output{{ ch_number }}_max",
                "title": "Current at 100% Proccess Value (mA)",
                "description": "level_100_current_description",
                "address": {{928 + ch_number - 1}},
                "reg_type": "holding",
                "default": 20,
                "scale": 0.001,
                "min": 0,
                "max": 20,
                "group": "gg_output_{{ ch_number }}_limits",
                "condition": "output_{{ch_number}}_mode==2"
            },
            {
                "id": "output{{ ch_number }}_decrement_rate",
                "title": "Decrement Rate (ms/%)",
                "description": "decrement_rate_description",
                "address": {{944 + ch_number - 1}},
                "reg_type": "holding",
                "default": 20,
                "min": 0,
                "max": 500,
                "group": "gg_output_{{ ch_number }}_rates"
            },
            {
                "id": "channel{{ ch_number }}_increment_rate",
                "title": "Increment Rate (ms/%)",
                "description": "increment_rate_description",
                "address": {{960 + ch_number - 1}},
                "reg_type": "holding",
                "default": 20,
                "min": 0,
                "max": 500,
                "group": "gg_output_{{ ch_number }}_rates"
            },
            {
                "id": "action{{ch_number}}_repeat_time",
                "title": "Changing Rate for Long Press Actions (ms/%)",
                "description": "action_repeat_time_description",
                "address": {{896 + ch_number - 1}},
                "reg_type": "holding",
                "default": 20,
                "min": 5,
                "max": 500,
                "group": "gg_output_{{ ch_number }}_rates"
            },
            {% endfor -%}
            {
                "id": "baud_rate",
                "title": "Baud rate",
                "description": "baud_rate_description",
                "address": 110,
                "reg_type": "holding",
                "enum": [96, 192, 384, 576, 1152],
                "default": 96,
                "enum_titles": [
                    "9600",
                    "19200",
                    "38400",
                    "57600",
                    "115200"
                ],
                "group": "general",
                "order": 1
            },
            {
                "id": "disable_indication",
                "title": "Status LED",
                "address": 130,
                "reg_type": "holding",
                "enum": [0, 1],
                "enum_titles": ["Enabled", "Disabled"],
                "default": 0,
                "group": "general"
            }
        ],
        "channels": [
            {% for index in range(0, INPUTS_NUMBER) -%}
            {
                "name": "Input {{index + 1}}",
                "reg_type": "discrete",
                "address": {{index}},
                "type": "switch",
                "group": "input_{{index + 1}}_counters"
            },
            {
                "name": "Input {{index + 1}} Counter",
                "reg_type": "input",
                "address": {{32 + index}},
                "type": "value",
                "sporadic": true,
                "enabled": false,
                "group": "input_{{index + 1}}_counters"
            },
            {
                "name": "Input {{index + 1}} Short Press Counter",
                "reg_type": "input",
                "address": {{464 + index}},
                "type": "value",
                "sporadic": true,
                "enabled": false,
                "group": "input_{{index + 1}}_counters"
            },
            {
                "name": "Input {{index + 1}} Long Press Counter",
                "reg_type": "input",
                "address": {{480 + index}},
                "type": "value",
                "sporadic": true,
                "enabled": false,
                "group": "input_{{index + 1}}_counters"
            },
            {
                "name": "Input {{index + 1}} Double Press Counter",
                "reg_type": "input",
                "address": {{496 + index}},
                "type": "value",
                "sporadic": true,
                "enabled": false,
                "group": "input_{{index + 1}}_counters"
            },
            {
                "name": "Input {{index + 1}} Short Long Press Counter",
                "reg_type": "input",
                "address": {{512 + index}},
                "type": "value",
                "sporadic": true,
                "enabled": false,
                "group": "input_{{index + 1}}_counters"
            },
            {% endfor -%}
            {% for index in range(0, OUTPUTS_NUMBER) -%}
            {
                "name": "Channel {{index + 1}} Switch",
                "reg_type": "coil",
                "address": {{index}},
                "type": "switch",
                "group": "gg_output_{{index + 1}}_channels"
            },
            {
                "name": "Channel {{index + 1}} Proccess Value",
                "reg_type": "holding",
                "address": {{index}},
                "type": "range",
                "max": 100,
                "scale": 0.1,
                "group": "gg_output_{{index + 1}}_channels"
            },
            {
                "name": "Channel {{index + 1}} Current",
                "reg_type": "holding",
                "address": {{16 + index}},
                "type": "value",
                "units": "mA",
                "max": 20,
                "scale": 0.001,
                "group": "gg_output_{{index + 1}}_channels"
            },
            {
                "name": "Channel {{index + 1}} Fault",
                "reg_type": "discrete",
                "address": {{16 + index}},
                "type": "switch",
                "sporadic": true,
                "group": "gg_output_{{index + 1}}_channels"
            },
            {% endfor -%}
            {
                "name": "Serial",
                "type": "text",
                "reg_type": "input",
                "address": 270,
                "format": "u32",
                "group": "hw_info"
            },
            {
                "name": "FW Version",
                "reg_type": "input",
                "address": 250,
                "type": "text",
                "format": "string",
                "string_data_size": 16,
                "enabled": false,
                "group": "hw_info"
            },
            {
                "name": "Supply voltage",
                "reg_type": "input",
                "address": 121,
                "type": "voltage",
                "scale": 0.001,
                "enabled": false,
                "group": "hw_info"
            },
            {
                "name": "Uptime",
                "reg_type": "input",
                "address": 104,
                "type": "text",
                "format": "u32",
                "enabled": false,
                "group": "hw_info"
            },
            {
                "name": "MCU Temperature",
                "reg_type": "input",
                "address": 124,
                "type": "temperature",
                "format": "s16",
                "scale": 0.1,
                "enabled": false,
                "group": "hw_info"
            },
            {
                "name": "MCU Voltage",
                "reg_type": "input",
                "address": 123,
                "scale": 0.001,
                "type": "voltage",
                "enabled": false,
                "group": "hw_info"
            },
            {% for index in range(0, OUTPUTS_NUMBER) -%}
            {
                "name": "Channel {{index + 1}} Duty Cycle Raw",
                "reg_type": "holding",
                "address": {{90 + index}},
                "type": "value",
                "enabled": true,
                "min": 0,
                "max": 2400,
                "group": "debug"
            }{% if not loop.last %},{% endif %}
            {% endfor -%}
        ],
        "translations": {
            "en": {
                "template_title": "{{ title_en }}",
                "pwm_frequency_factor_description": "PWM frequency is calculated by formula: 20 kHz / Factor ",
                "baud_rate_description": "Make sure that communication with device is established before changing this parameter. Select required baud rate, save configuration and then change port baud rate to the same value.",
                "Uptime": "Uptime (s)",

                {% for ch_number in range(1, OUTPUTS_NUMBER + 1) -%}
                "Channel {{ch_number}}": "Channel {{ch_number}}",
                {% endfor -%}

                "input_hold_time_description": "Presses that last longer than the specified time are counted as long presses",
                "input_double_time_description": "If there is no second press during the specified time then press is single. 0 - disables all presses except short and long. Adds a delay to the response to a short press",
                "input_debounce_time_description": "Must be 5-10 times less than second press waiting time. Adds a delay to the response to presses"
            },
            "ru": {
                "Enabled": "–ê–∫—Ç–∏–≤–µ–Ω",
                "Disabled": "–û—Ç–∫–ª—é—á–µ–Ω",
                "template_title": "{{ title_ru }}",
                "Outputs": "–í—ã—Ö–æ–¥—ã",
                "General": "–û–±—â–µ–µ",
                "HW Info": "–î–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª—è",
                "Debug": "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
                "PWM Frequency Factor": "–î–µ–ª–∏—Ç–µ–ª—å —á–∞—Å—Ç–æ—Ç—ã –®–ò–ú",
                "pwm_frequency_factor_description": "–ß–∞—Å—Ç–æ—Ç–∞ –®–ò–ú —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: 20 –∫–ì—Ü / –î–µ–ª–∏—Ç–µ–ª—å",
                "Baud rate": "–°–∫–æ—Ä–æ—Å—Ç—å –æ–±–º–µ–Ω–∞",
                "baud_rate_description": "–ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–≤—è–∑—å —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±–º–µ–Ω–∞, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∞ –∑–∞—Ç–µ–º —É–∫–∞–∂–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–æ—Ä—Ç–∞ —ç—Ç—É –∂–µ —Å–∫–æ—Ä–æ—Å—Ç—å.",

                {% for ch_number in range(1, INPUTS_NUMBER + 1) -%}
                "Input {{ch_number}}": "–í—Ö–æ–¥ {{ch_number}}",
                "Input {{ch_number}} Counter": "–°—á–µ—Ç—á–∏–∫ {{ch_number}}",
                "Input {{ch_number}} Short Press Counter": "–°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–æ—Ç–∫–∏—Ö –Ω–∞–∂–∞—Ç–∏–π –≤—Ö–æ–¥–∞ {{ch_number}}",
                "Input {{ch_number}} Long Press Counter": "–°—á–µ—Ç—á–∏–∫ –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π –≤—Ö–æ–¥–∞ {{ch_number}}",
                "Input {{ch_number}} Double Press Counter": "–°—á–µ—Ç—á–∏–∫ –¥–≤–æ–π–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π –≤—Ö–æ–¥–∞ {{ch_number}}",
                "Input {{ch_number}} Short Long Press Counter": "–°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–æ—Ç–∫–∏—Ö, –∞ –∑–∞—Ç–µ–º –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π –≤—Ö–æ–¥–∞ {{ch_number}}",
                {% endfor -%}

                {% for ch_number in range(1, OUTPUTS_NUMBER + 1) -%}
                "Output {{ch_number}}": "–í—ã—Ö–æ–¥ {{ch_number}}",
                "Channel {{ch_number}}": "–ö–∞–Ω–∞–ª {{ch_number}}",
                "Channel {{ch_number}} Duty Cycle Raw": "–ü—Ä—è–º–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–∫–≤–∞–∂–Ω–æ—Å—Ç–∏ –®–ò–ú –Ω–∞ –≤—ã—Ö–æ–¥–µ {{ch_number}}",
                {% endfor -%}

                "Outputs Common Settings": "–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—Ö–æ–¥–æ–≤",

                "Serial": "–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä",
                "FW Version": "–í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏",
                "Supply voltage": "–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è",
                "Uptime": "–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–º–µ–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∏—è (—Å)",
                "MCU Temperature": "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ú–ö",
                "MCU Voltage": "–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è –ú–ö",
                "Status LED": "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è",

                "Long Press Time (ms)": "–í—Ä–µ–º—è –¥–ª–∏–Ω–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è (–º—Å)",
                "Second Press Waiting Time (ms)": "–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è (–º—Å)",
                "Debounce Time (ms)": "–í—Ä–µ–º—è –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ (–º—Å)",

                "input_mode_description": "–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –≤—Ö–æ–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –∫–Ω–æ–ø–∫–∞ –±–µ–∑ —Ñ–∏–∫—Å–∞—Ü–∏–∏. –†–∞–±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è —Å —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –¥–æ—Å—Ç—É–ø–Ω–∞ —Å –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—à–∏–≤–∫–∏ 2.5.0",

                "input_hold_time_description": "–ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∏–µ –¥–ª–∏—Ç—Å—è –±–æ–ª—å—à–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - —Å—á–∏—Ç–∞–µ–º –µ–≥–æ –¥–ª–∏–Ω–Ω—ã–º",
                "input_double_time_description": "–ï—Å–ª–∏ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—Ç–æ—Ä–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è –Ω–µ –±—ã–ª–æ - —Å—á–∏—Ç–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –æ–¥–∏–Ω–æ—á–Ω—ã–º. 0 - –æ—Ç–∫–ª—é—á–∏—Ç –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫—Ä–æ–º–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∏ –¥–ª–∏–Ω–Ω–æ–≥–æ. –í–Ω–æ—Å–∏—Ç –∑–∞–¥–µ—Ä–∂–∫—É –≤ —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ",
                "input_debounce_time_description": "–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ 5-10 —Ä–∞–∑ –º–µ–Ω—å—à–µ, —á–µ–º –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è. –í–Ω–æ—Å–∏—Ç –∑–∞–¥–µ—Ä–∂–∫—É –≤ —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è",

                "decrease_rate_description": "–í–æ –≤—Ä–µ–º—è –ø–ª–∞–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –≤—ã—Ö–æ–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –Ω–∞ 1% —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏. –ü—Ä–∏ 0 –∑–Ω–∞—á–µ–Ω–∏–∏, —É—Ä–æ–≤–µ–Ω—å —É–º–µ–Ω—å—à–∏—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ",
                "increase_rate_description": "–í–æ –≤—Ä–µ–º—è –ø–ª–∞–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –≤—ã—Ö–æ–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ 1% —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏. –ü—Ä–∏ 0 –∑–Ω–∞—á–µ–Ω–∏–∏, —É—Ä–æ–≤–µ–Ω—å —É–≤–µ–ª–∏—á–∏—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ",
                "action_repeat_time_description": "–í–æ –≤—Ä–µ–º—è –¥–æ–ª–≥–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –≤—ã—Ö–æ–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å –±—É–¥–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –Ω–∞ 1% —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏"
            }
        }
    }
}
